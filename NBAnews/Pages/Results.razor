@page "/results"
@inject HttpClient Http
@using RestSharp
@using NBAnews.Model

<PageTitle>Last results</PageTitle>

<MudText Typo="Typo.h3" GutterBottom="true">Last results</MudText>

@if (_resultItems == null)
{
    <MudProgressCircular Color="Color.Default" Indeterminate="true" />
}
else
{
    <MudTable Items="_games" Hover="true" SortLabel="Sort By" Elevation="0">
        <HeaderContent>
            <MudTh>Date</MudTh>
            <MudTh>Home team</MudTh>
            <MudTh>Home team score</MudTh>
            <MudTh>Versus team</MudTh>
            <MudTh>Versus team score</MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="Date">@context.StartTimeUtc.Date.ToShortDateString()</MudTd>
            <MudTd DataLabel="Temp. (C)">@context.HTeam.FullName</MudTd>
            <MudTd DataLabel="Temp. (F)">@context.HTeam.Score.Points</MudTd>
            <MudTd DataLabel="Summary">@context.VTeam.FullName</MudTd>
            <MudTd DataLabel="Summary">@context.VTeam.Score.Points</MudTd>
        </RowTemplate>
        <PagerContent>
            <MudTablePager PageSizeOptions="new int[]{50, 100}" />
        </PagerContent>
    </MudTable>
}


@code {
    private IRestResponse<Result>? _resultItems;
    private List<Game> _games;
    private Result? results;

    protected override async Task OnInitializedAsync()
    {
        var client = new RestClient("https://api-nba-v1.p.rapidapi.com/games/date/2021-12-23");
        client.Timeout = -1;
        var request = new RestRequest(Method.GET);
        request.AddHeader("x-rapidapi-host", "api-nba-v1.p.rapidapi.com");
        request.AddHeader("x-rapidapi-key", "320aa979eamshbb837acae064e6bp1f6968jsn57008a862c0f");
        IRestResponse response = client.Execute(request);
        Console.WriteLine(response.Content);

    
    }

    // create request object
    //    var request = new HttpRequestMessage(HttpMethod.Get, "https://api-nba-v1.p.rapidapi.com/games/date/2021-12-23");

    //// add authorization header
    //    request.Headers.Authorization = new AuthenticationHeaderValue("x-rapidapi-key", "320aa979eamshbb837acae064e6bp1f6968jsn57008a862c0f");

    //// add custom http header
    //    request.Headers.Add("x-rapidapi-host", "api-nba-v1.p.rapidapi.com");

        

    //// send request
    //    using var httpResponse = await Http.SendAsync(request);

    //// convert http response data to UsersResponse object
    //    results = await httpResponse.Content.ReadFromJsonAsync<Result>();

    //Http.DefaultRequestHeaders.Add("x-rapidapi-host", "api-nba-v1.p.rapidapi.com");
    //Http.DefaultRequestHeaders.Add("x-rapidapi-key", "320aa979eamshbb837acae064e6bp1f6968jsn57008a862c0f");

    //if (Http != null) results = await Http.GetFromJsonAsync<Result>();

    //if (results?.Api.Game != null) _games = results.Api.Games;

   
   
}
